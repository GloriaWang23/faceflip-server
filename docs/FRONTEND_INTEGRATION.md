# 前端图像生成功能使用说明

## 功能概述

前端 `ImageUpload.vue` 组件现在集成了图像生成功能，用户上传图片后可以调用后端的SSE接口生成新的图像。

## 使用流程

1. **上传图片**: 用户选择或拖拽图片到上传区域
2. **点击生成**: 上传成功后，点击"生成新图像"按钮
3. **实时状态**: 通过SSE实时显示生成进度
4. **查看结果**: 生成完成后显示所有生成的图像

## 新增功能

### 1. 生成按钮
- 位置：上传成功后的区域
- 状态：生成中时禁用
- 样式：绿色按钮，悬停效果

### 2. 实时状态显示
- **开始**: 🚀 蓝色提示框
- **处理中**: ⚙️ 黄色提示框 + 加载动画
- **成功**: ✅ 绿色提示框
- **失败**: ❌ 红色提示框

### 3. 生成结果展示
- 网格布局显示所有生成的图像
- 每张图片显示尺寸信息
- 提供"查看原图"链接

## 技术实现

### SSE事件处理
```javascript
// 处理不同的事件类型
switch (data.event) {
  case 'start':    // 开始生成
  case 'process':  // 处理中
  case 'done':     // 完成
  case 'error':    // 错误
}
```

### 状态管理
- `generating`: 是否正在生成
- `generationStatus`: 当前生成状态
- `generatedImages`: 生成的图像列表

### 错误处理
- 网络错误处理
- SSE解析错误处理
- 用户友好的错误提示

## 样式特性

### 响应式设计
- 移动端适配
- 网格布局自适应
- 触摸友好的按钮大小

### 视觉反馈
- 加载动画
- 状态颜色区分
- 悬停效果

## 注意事项

1. **API地址**: 确保后端服务运行在正确端口
2. **CORS**: 后端已配置CORS支持
3. **环境变量**: 确保ARK_API_KEY已正确设置
4. **图片格式**: 支持常见图片格式
5. **文件大小**: 限制10MB以内

## 测试步骤

1. 启动后端服务: `uv run python run.py`
2. 启动前端服务: `cd ui && npm run dev`
3. 访问前端页面
4. 上传一张图片
5. 点击"生成新图像"
6. 观察SSE事件流和结果展示

## 故障排除

### 常见问题

1. **生成按钮不可点击**
   - 检查图片是否上传成功
   - 确认uploadResult.publicUrl存在

2. **SSE连接失败**
   - 检查后端服务是否运行
   - 确认API路径正确

3. **生成失败**
   - 检查ARK_API_KEY环境变量
   - 查看后端日志

4. **图片不显示**
   - 检查图片URL是否可访问
   - 确认CORS配置正确
