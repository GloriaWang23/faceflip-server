# ARK API 配置指南

## 概述

ARK API 是火山引擎提供的图像生成服务，用于生成高质量的AI图像。本应用使用ARK API来实现图像生成功能。

## 配置步骤

### 1. 获取API密钥

1. 访问 [火山引擎控制台](https://console.volcengine.com/)
2. 注册并登录账号
3. 进入ARK服务页面
4. 创建API密钥

### 2. 配置环境变量

在项目根目录的 `.env` 文件中添加：

```bash
# ARK API (火山引擎) - 图像生成服务
ARK_API_KEY=your_actual_ark_api_key_here
```

**注意**: 将 `your_actual_ark_api_key_here` 替换为你的实际API密钥。

### 3. 重启服务

配置完成后，重启服务器以使环境变量生效：

```bash
# 停止当前服务 (Ctrl+C)
# 重新启动服务
python -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

## 验证配置

### 方法1: 检查环境变量

```bash
# 在服务器终端中检查
echo $ARK_API_KEY
```

### 方法2: 测试图像生成

1. 上传一张图片
2. 点击"生成新图像"按钮
3. 如果配置正确，应该看到生成进度而不是API密钥错误

## 错误处理

### 常见错误

1. **"ARK_API_KEY 环境变量未设置"**
   - 原因: `.env` 文件中没有配置 `ARK_API_KEY`
   - 解决: 按照上述步骤配置API密钥

2. **"API调用失败"**
   - 原因: API密钥无效或已过期
   - 解决: 检查API密钥是否正确，或重新生成

3. **"权限不足"**
   - 原因: API密钥没有图像生成权限
   - 解决: 在火山引擎控制台中检查API权限设置

### 前端错误提示

应用现在会显示更友好的错误信息：

- 🔑 **API密钥未配置**: 提示联系管理员配置
- 🔐 **认证失败**: 提示重新登录
- 🚫 **权限不足**: 提示联系管理员获取权限
- 🌐 **网络错误**: 提供重试按钮
- 📊 **API限制**: 提示稍后重试

## 费用说明

ARK API 按调用次数收费，具体费用请参考火山引擎官方定价。

## 技术支持

如果遇到配置问题，请：

1. 检查火山引擎官方文档
2. 确认API密钥权限设置
3. 查看服务器日志获取详细错误信息
4. 联系技术支持团队

## 安全注意事项

- 不要将API密钥提交到版本控制系统
- 定期轮换API密钥
- 在生产环境中使用环境变量而非硬编码
- 限制API密钥的权限范围
